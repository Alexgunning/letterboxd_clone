import { __awaiter } from "tslib";
import path from "path";
export function typegenFormatPrettier(prettierConfig) {
    return function formatTypegen(content, type) {
        return __awaiter(this, void 0, void 0, function* () {
            let prettier;
            /* istanbul ignore next */
            try {
                prettier = require("prettier");
            }
            catch (_a) {
                console.warn("It looks like you provided a `prettierConfig` option to GraphQL Nexus, but you do not have prettier " +
                    "installed as a dependency in your project. Please add it as a peerDependency of nexus to use this feature. " +
                    "Skipping formatting.");
                return content;
            }
            if (typeof prettierConfig === "string") {
                /* istanbul ignore if */
                if (!path.isAbsolute(prettierConfig)) {
                    console.error(new Error(`Expected prettierrc path to be absolute, saw ${prettierConfig}. Skipping formatting.`));
                    return content;
                }
                const fs = require("fs");
                const util = require("util");
                const readFile = util.promisify(fs.readFile);
                prettierConfig = JSON.parse(yield readFile(prettierConfig, "utf8"));
            }
            return prettier.format(content, Object.assign(Object.assign({}, prettierConfig), { parser: type === "types" ? "typescript" : "graphql" }));
        });
    };
}
//# sourceMappingURL=typegenFormatPrettier.js.map